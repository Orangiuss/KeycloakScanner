import requests # type: ignore
import time
import argparse
import urllib.parse
import re
import string
import os

# ASCII art
ascii_art = """\033[91m
  _  __            _           _    ___                            
 | |/ /___ _  _ __| |___  __ _| |__/ __| __ __ _ _ _  _ _  ___ _ _ 
 | ' </ -_) || / _| / _ \/ _` | / /\__ \/ _/ _` | ' \| ' \/ -_) '_|
 |_|\_\___|\_, \__|_\___/\__,_|_\_\|___/\__\__,_|_||_|_||_\___|_|  
           |__/                                                    
    \033[0m                                                                                          
"""

############## FONCTIONS ##############

class colors:
    RED = '\033[91m'
    GREEN = '\033[92m'
    BLUE = '\033[94m'
    RED_BOLD = '\033[91m\033[1m'
    GREEN_BOLD = '\033[92m\033[1m'
    BLUE_BOLD = '\033[94m\033[1m'
    END = '\033[0m'

def print_redb(text):
    print(f"{colors.RED_BOLD}{text}{colors.END}")

def error(text):
    print_redb(f"[X]: {text}")

def print_greenb(text):
    print(f"{colors.GREEN_BOLD}{text}{colors.END}")

def success(text):
    print_greenb(f"[✓]: {text}")

def print_red(text):
    print(f"{colors.RED}{text}{colors.END}")

def print_green(text):
    print(f"{colors.GREEN}{text}{colors.END}")

def print_blue(text):
    print(f"{colors.BLUE}{text}{colors.END}")

def print_blueb(text):
    print(f"{colors.BLUE_BOLD}{text}{colors.END}")

def info(text):
    print_blueb(f"[-]: {text}")

# Encode une chaîne de caractères conformément aux spécifications URL.
def urlencode(string_to_encode):
    return urllib.parse.quote(string_to_encode)

def urlencode_in_tags(input_string):
    return re.sub(r'<@urlencode>(.*?)<@/urlencode>', lambda x: f"{urllib.parse.quote(x.group(1))}", input_string)


############## FONCTIONS DE PENTEST ##############

# Récupère la version de Keycloak à partir de l'entête X-Keycloak-Version

def is_valid_url(url):
    return re.match(r"^https?://", url)

def is_valid_file(file):
    # Check if the file is a text file and if it exists
    return re.match(r".*\.txt$", file) and os.path.isfile(file)